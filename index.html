<!DOCTYPE html>
<html lang="vi" data-theme="neural-dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Black Shop MMO Pro - Ultra Enhanced ✨</title>

    <!-- ===== THƯ VIỆN & FONTS ===== -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;700;800;900&family=Orbitron:wght@400;700;900&family=Space+Grotesk:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- FONT AWESOME -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>

    <style>
        /* =====================================================================
           1. DESIGN TOKENS & DYNAMIC THEME SETUP
           ===================================================================== */
        :root {
            --font-main: 'Plus Jakarta Sans', sans-serif;
            --font-display: 'Orbitron', monospace;
            --font-accent: 'Space Grotesk', sans-serif;
            --ease-out-quint: cubic-bezier(0.23, 1, 0.32, 1);
            --ease-in-out-cubic: cubic-bezier(0.645, 0.045, 0.355, 1);
            --ease-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
            --ease-elastic: cubic-bezier(0.175, 0.885, 0.32, 1.275);
            --bg-primary: #191724; --bg-secondary: #201e2d; --bg-glass: rgba(32, 30, 45, 0.7); --text-primary: #e0def4; --text-secondary: #908caa; --text-heading: #ffffff; --border-primary: #2e2a3f; --accent-primary: #c3a6ff; --accent-secondary: #e0def4; --shadow-color: rgba(195, 166, 255, 0.15);
        }
        [data-theme="neural-dark"] { --bg-primary: #0a0a0f; --bg-secondary: #111118; --bg-glass: rgba(17, 17, 24, 0.7); --text-primary: #cccccc; --text-secondary: #88889a; --text-heading: #ffffff; --border-primary: #252530; --accent-primary: #00f5ff; --accent-secondary: #74f9ff; --shadow-color: rgba(0, 245, 255, 0.2); }
        [data-theme="forest-dew"] { --bg-primary: #0f1a14; --bg-secondary: #14201a; --bg-glass: rgba(20, 32, 26, 0.7); --text-primary: #b8d8cb; --text-secondary: #79998a; --text-heading: #ffffff; --border-primary: #23382d; --accent-primary: #4deeb2; --accent-secondary: #90f5d1; --shadow-color: rgba(77, 238, 178, 0.15); }
        [data-theme="sunset-glow"] { --bg-primary: #21140f; --bg-secondary: #2b1a14; --bg-glass: rgba(43, 26, 20, 0.7); --text-primary: #f5d3c5; --text-secondary: #b89182; --text-heading: #ffffff; --border-primary: #4d2f25; --accent-primary: #ff8c69; --accent-secondary: #ffbba8; --shadow-color: rgba(255, 140, 105, 0.2); }
        [data-theme="cosmic-dark"] { --bg-primary: #04040a; --bg-secondary: #100f22; --bg-glass: rgba(12, 11, 26, 0.7); --text-primary: #f0f0f5; --text-secondary: #a0a0c0; --text-heading: #FFFFFF; --border-primary: rgba(67, 79, 138, 0.25); --accent-primary: #8b5cf6; --accent-secondary: #3b82f6; --shadow-color: rgba(139, 92, 246, 0.2); }

        /* =====================================================================
           2. FONT CHUYỂN ĐỘNG SIÊU ĐẲNG CẤP
           ===================================================================== */
        .text-animated {
            background: linear-gradient(45deg, var(--accent-primary), var(--accent-secondary), var(--text-heading), var(--accent-primary));
            background-size: 400% 400%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: epicTextFlow 3s ease-in-out infinite, textGlow 2s ease-in-out infinite alternate;
            position: relative;
            font-family: var(--font-display);
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            display: inline-block; /* Thêm để span hoạt động đúng */
        }
        
        @keyframes epicTextFlow {
            0%, 100% { background-position: 0% 50%; }
            25% { background-position: 100% 50%; }
            50% { background-position: 50% 100%; }
            75% { background-position: 100% 0%; }
        }
        
        @keyframes textGlow {
            0% { text-shadow: 0 0 20px var(--shadow-color), 0 0 40px var(--shadow-color); }
            100% { text-shadow: 0 0 40px var(--shadow-color), 0 0 80px var(--shadow-color); }
        }
        
        .text-animated::before {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%; /* Thêm để ::before khớp kích thước */
            height: 100%; /* Thêm để ::before khớp kích thước */
            background: linear-gradient(45deg, transparent, var(--accent-primary), transparent);
            background-size: 200% 100%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: shimmerText 2s infinite;
            z-index: 1;
        }
        
        @keyframes shimmerText {
            0% { background-position: -200% 0; opacity: 0; }
            50% { opacity: 1; }
            100% { background-position: 200% 0; opacity: 0; }
        }
        
        .text-bounce {
            animation: textBounce 2s ease-in-out infinite;
            font-family: var(--font-accent);
            font-weight: 700;
        }
        
        @keyframes textBounce {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-10px) scale(1.05); }
        }
        
        .text-wave {
            display: inline-block;
            font-family: var(--font-accent);
            font-weight: 600;
        }
        
        .text-wave span {
            display: inline-block;
            animation: wave 2s ease-in-out infinite;
            animation-delay: calc(var(--i) * 0.1s);
            color: var(--accent-primary);
            text-shadow: 0 0 10px var(--shadow-color);
        }
        
        @keyframes wave {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-15px) rotate(5deg); }
            50% { transform: translateY(-5px) rotate(-3deg); }
            75% { transform: translateY(-10px) rotate(2deg); }
        }
        
        .text-electric {
            font-family: var(--font-display);
            background: linear-gradient(45deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            position: relative;
            animation: electricPulse 1.5s ease-in-out infinite;
        }
        
        @keyframes electricPulse {
            0%, 100% { 
                text-shadow: 0 0 5px var(--accent-primary), 0 0 10px var(--accent-primary);
                filter: brightness(1);
            }
            50% { 
                text-shadow: 0 0 20px var(--accent-primary), 0 0 30px var(--accent-primary), 0 0 40px var(--accent-primary);
                filter: brightness(1.5);
            }
        }

        /* =====================================================================
           3. HIỆU ỨNG PARTICLES & BACKGROUND CHUYỂN ĐỘNG MẠNH HƠN
           ===================================================================== */
        #particles-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -2; pointer-events: none; }
        #starry-sky { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none;}
        
        .floating-icons {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
            overflow: hidden;
        }
        
        .floating-icon {
            position: absolute;
            font-size: 2rem;
            opacity: 0.15;
            animation: floatAround 12s infinite linear;
            color: var(--accent-primary);
            text-shadow: 0 0 20px var(--shadow-color);
        }
        
        @keyframes floatAround {
            0% { transform: translateY(100vh) translateX(-100px) rotate(0deg) scale(0.5); opacity: 0; }
            10% { opacity: 0.4; }
            90% { opacity: 0.1; }
            100% { transform: translateY(-100px) translateX(100px) rotate(720deg) scale(1.5); opacity: 0; }
        }

        /* =====================================================================
           4. KIỂU CƠ BẢN & BỐ CỤC CHO DI ĐỘNG
           ===================================================================== */
        html { 
            transition: all 0.8s var(--ease-in-out-cubic); 
            overflow-x: hidden;
        }
        body {
            font-family: var(--font-main);
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 50%, var(--bg-primary) 100%);
            color: var(--text-primary);
            padding-bottom: 90px;
            position: relative;
            overflow-x: hidden;
            animation: backgroundPulse 6s ease-in-out infinite alternate;
        }
        
        @keyframes backgroundPulse {
            0% { background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 50%, var(--bg-primary) 100%); }
            33% { background: linear-gradient(225deg, var(--bg-secondary) 0%, var(--bg-primary) 50%, var(--bg-secondary) 100%); }
            66% { background: linear-gradient(315deg, var(--bg-primary) 0%, var(--bg-secondary) 50%, var(--bg-primary) 100%); }
            100% { background: linear-gradient(45deg, var(--bg-secondary) 0%, var(--bg-primary) 50%, var(--bg-secondary) 100%); }
        }

        ::-webkit-scrollbar { width: 12px; }
        ::-webkit-scrollbar-track { background: var(--bg-primary); border-radius: 10px; }
        ::-webkit-scrollbar-thumb { 
            background: linear-gradient(45deg, var(--accent-primary), var(--accent-secondary)); 
            border-radius: 10px; 
            border: 2px solid var(--bg-primary);
            box-shadow: 0 0 15px var(--shadow-color);
            animation: scrollGlow 2s ease-in-out infinite alternate;
        }
        
        @keyframes scrollGlow {
            0% { box-shadow: 0 0 15px var(--shadow-color); }
            100% { box-shadow: 0 0 25px var(--shadow-color), 0 0 35px var(--shadow-color); }
        }

        /* =====================================================================
           5. HEADER SIÊU ĐẲNG CẤP VỚI TEXT ANIMATED
           ===================================================================== */
        .header {
            animation: epicHeaderEntrance 2s var(--ease-bounce) 0.3s forwards;
            opacity: 0;
            padding: 1.5rem 1.5rem 0 1.5rem;
            position: relative;
            overflow: hidden;
        }
        
        @keyframes epicHeaderEntrance {
            0% { opacity: 0; transform: translateY(-100px) scale(0.8) rotateX(45deg); }
            50% { opacity: 0.8; transform: translateY(10px) scale(1.1) rotateX(-10deg); }
            100% { opacity: 1; transform: translateY(0) scale(1) rotateX(0deg); }
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, var(--accent-primary), transparent);
            opacity: 0.2;
            animation: shine 2s infinite;
        }
        
        @keyframes shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .header h2::after {
            content: '✨';
            position: absolute;
            right: -40px;
            top: -10px;
            font-size: 2rem;
            animation: sparkle 1.5s ease-in-out infinite;
        }
        
        @keyframes sparkle {
            0%, 100% { transform: scale(1) rotate(0deg); opacity: 1; }
            25% { transform: scale(1.3) rotate(90deg); opacity: 0.8; }
            50% { transform: scale(1.5) rotate(180deg); opacity: 0.6; }
            75% { transform: scale(1.2) rotate(270deg); opacity: 0.9; }
        }
        
        .header p {
            animation: fadeInUp 1s var(--ease-out-quint) 1s forwards;
            opacity: 0;
            transform: translateY(20px);
        }
        
        @keyframes fadeInUp {
            to { opacity: 1; transform: translateY(0); }
        }

        #theme-switcher-btn-header {
            color: var(--text-secondary);
            transition: all 0.5s var(--ease-bounce);
            position: relative;
            overflow: hidden;
        }
        
        #theme-switcher-btn-header::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: radial-gradient(circle, var(--accent-primary), transparent);
            transform: translate(-50%, -50%);
            transition: all 0.5s var(--ease-out-quint);
            border-radius: 50%;
            z-index: -1;
        }
        
        #theme-switcher-btn-header:active {
            color: var(--accent-primary);
            transform: scale(1.2) rotate(360deg);
            text-shadow: 0 0 20px var(--shadow-color);
        }
        
        #theme-switcher-btn-header:active::before {
            width: 60px;
            height: 60px;
            opacity: 0.3;
        }

        /* =====================================================================
           6. THẺ THEME SIÊU ĐỈNH CAO VỚI TEXT ANIMATED
           ===================================================================== */
        .theme-card {
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-primary)); 
            border-radius: 24px; 
            border: 2px solid var(--border-primary);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3), 0 0 20px var(--shadow-color); 
            position: relative; 
            overflow: hidden;
            transition: all 0.6s var(--ease-bounce);
            opacity: 0; 
            transform: translateY(60px) scale(0.9) rotateX(15deg);
            cursor: pointer;
        }
        
        .theme-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(from 0deg, var(--accent-primary), transparent, var(--accent-secondary), transparent, var(--accent-primary));
            opacity: 0;
            animation: rotate 3s linear infinite;
            transition: opacity 0.5s;
            z-index: 1;
        }
        
        @keyframes rotate {
            100% { transform: rotate(360deg); }
        }
        
        .theme-card:hover::before {
            opacity: 0.15;
        }
        
        .theme-card::after {
            content: '';
            position: absolute;
            inset: 2px;
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-primary));
            border-radius: 22px;
            z-index: 2;
        }
        
        .theme-card > * {
            position: relative;
            z-index: 3;
        }
        
        .theme-card.visible {
            opacity: 1; 
            transform: translateY(0) scale(1) rotateX(0deg);
        }
        
        .theme-card:hover {
            transform: translateY(-15px) scale(1.05) rotateY(5deg);
            box-shadow: 0 25px 60px rgba(0,0,0,0.4), 0 0 40px var(--shadow-color);
        }
        
        .theme-card:active {
            transform: scale(0.95) rotateY(0deg);
            box-shadow: 0 10px 25px var(--shadow-color);
        }
        
        .card-image-wrapper {
            position: relative;
            overflow: hidden;
        }
        
        .card-image-wrapper::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            z-index: 1;
            transition: left 0.8s var(--ease-out-quint);
        }
        
        .theme-card:hover .card-image-wrapper::before {
            left: 100%;
        }
        
        .card-image-wrapper img {
            transition: all 0.8s var(--ease-out-quint);
            filter: brightness(0.9) saturate(1.1);
        }
        
        .theme-card:hover .card-image-wrapper img {
            transform: scale(1.15) rotate(2deg);
            filter: brightness(1.1) saturate(1.3);
        }
        
        .category-pill { 
            display: inline-flex; 
            align-items: center; 
            gap: 8px; 
            font-size: 0.75rem; 
            font-weight: 700; 
            padding: 8px 16px; 
            border-radius: 999px; 
            border: 2px solid var(--accent-primary); 
            color: var(--accent-primary); 
            background: linear-gradient(135deg, transparent, var(--accent-primary));
            background-size: 0% 100%;
            background-repeat: no-repeat;
            transition: all 0.5s var(--ease-bounce);
            position: relative;
            overflow: hidden;
            font-family: var(--font-accent);
        }
        
        .category-pill::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--accent-primary);
            opacity: 0;
            transition: opacity 0.3s;
            z-index: -1;
        }
        text-animated
        .theme-card:hover .category-pill {
            background-size: 100% 100%;
            color: var(--bg-primary);
            transform: scale(1.1);
            box-shadow: 0 0 20px var(--shadow-color);
        }
        
        .theme-card:hover .category-pill::before {
            opacity: 0.2;
        }

        /* =====================================================================
           7. THANH ĐIỀU HƯỚNG DƯỚI SIÊU NGẦU
           ===================================================================== */
        .bottom-nav {
            position: fixed;
            bottom: 0; left: 0; right: 0;
            height: 75px;
            background: linear-gradient(135deg, var(--bg-glass), rgba(0,0,0,0.3));
            backdrop-filter: blur(25px) saturate(1.5);
            -webkit-backdrop-filter: blur(25px) saturate(1.5);
            border-top: 2px solid var(--border-primary);
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 1000;
            padding-bottom: env(safe-area-inset-bottom);
            box-shadow: 0 -15px 50px rgba(0,0,0,0.4), 0 0 30px var(--shadow-color);
            transition: all 0.5s var(--ease-in-out-cubic);
            animation: navGlow 3s ease-in-out infinite alternate;
        }
        
        @keyframes navGlow {
            0% { box-shadow: 0 -15px 50px rgba(0,0,0,0.4), 0 0 30px var(--shadow-color); }
            100% { box-shadow: 0 -15px 50px rgba(0,0,0,0.4), 0 0 50px var(--shadow-color); }
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 0.7rem;
            transition: all 0.5s var(--ease-bounce);
            position: relative;
            padding: 8px;
            border-radius: 12px;
            overflow: hidden;
            font-family: var(--font-accent);
        }
        
        .nav-item::before {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at center, var(--accent-primary), transparent);
            opacity: 0;
            transition: all 0.4s var(--ease-out-quint);
            z-index: -1;
        }
        
        .nav-item i { 
            font-size: 1.4rem; 
            transition: all 0.4s var(--ease-bounce);
        }
        
        .nav-item.active {
            color: var(--accent-primary);
            transform: translateY(-10px) scale(1.1);
            text-shadow: 0 0 15px var(--shadow-color);
        }
        
        .nav-item.active::before {
            opacity: 0.2;
        }
        
        .nav-item.active i {
            animation: iconBounce 1.5s ease-in-out infinite;
        }
        
        @keyframes iconBounce {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-5px) rotate(15deg); }
        }
        
        .nav-item:active {
            transform: translateY(-8px) scale(0.95);
        }

        /* =====================================================================
           8. MODAL THEME SWITCHER ĐẲNG CẤP
           ===================================================================== */
        #theme-switcher-modal {
            position: fixed;
            inset: 0;
            z-index: 2000;
            background: radial-gradient(circle at center, rgba(0,0,0,0.8), rgba(0,0,0,0.6));
            backdrop-filter: blur(15px) saturate(1.2);
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: all 0.6s var(--ease-in-out-cubic);
        }
        
        #theme-switcher-modal.visible {
            opacity: 1;
            pointer-events: auto;
        }
        
        #theme-menu {
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-primary));
            border: 3px solid var(--border-primary);
            border-radius: 32px;
            padding: 2.5rem;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 30px 80px rgba(0,0,0,0.5), 0 0 50px var(--shadow-color);
            transform: scale(0.7) translateY(50px) rotateX(15deg);
            transition: all 0.6s var(--ease-bounce);
            position: relative;
            overflow: hidden;
        }
        
        #theme-menu::before {
            content: '';
            position: absolute;
            inset: -2px;
            background: conic-gradient(from 0deg, var(--accent-primary), var(--accent-secondary), var(--accent-primary));
            border-radius: 34px;
            z-index: -1;
            animation: rotate 4s linear infinite;
        }
        
        #theme-switcher-modal.visible #theme-menu {
            transform: scale(1) translateY(0) rotateX(0deg);
        }
        
        .theme-option { 
            width: 64px; 
            height: 64px; 
            border-radius: 50%; 
            border: 4px solid transparent; 
            transition: all 0.5s var(--ease-bounce); 
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .theme-option::before {
            content: '';
            position: absolute;
            inset: -10px;
            background: conic-gradient(from 0deg, transparent, var(--accent-primary), transparent);
            border-radius: 50%;
            opacity: 0;
            transition: all 0.4s;
            animation: rotate 2s linear infinite;
        }
        
        .theme-option:hover::before {
            opacity: 0.6;
        }
        
        .theme-option:active {
            transform: scale(0.85);
        }
        
        .theme-option.active { 
            border-color: var(--accent-primary); 
            box-shadow: 0 0 30px var(--shadow-color), inset 0 0 20px rgba(255,255,255,0.1); 
            transform: scale(1.2);
            animation: activeThemePulse 1.5s ease-in-out infinite;
        }
        
        @keyframes activeThemePulse {
            0%, 100% { transform: scale(1.2); }
            50% { transform: scale(1.3); }
        }
        
        .theme-option[data-theme-set="neural-dark"] { background: linear-gradient(135deg, #00f5ff, #111118, #00f5ff); }
        .theme-option[data-theme-set="purple-mist"] { background: linear-gradient(135deg, #c3a6ff, #191724, #c3a6ff); }
        .theme-option[data-theme-set="forest-dew"] { background: linear-gradient(135deg, #4deeb2, #0f1a14, #4deeb2); }
        .theme-option[data-theme-set="sunset-glow"] { background: linear-gradient(135deg, #ff8c69, #21140f, #ff8c69); }
        .theme-option[data-theme-set="cosmic-dark"] { background: linear-gradient(135deg, #8b5cf6, #0C0B1A, #8b5cf6); }

        /* =====================================================================
           9. MODAL CHI TIẾT THEME ĐỈNH CAO VỚI VIDEO & MULTIPLE IMAGES
           ===================================================================== */
        #modal-backdrop { 
            opacity: 0; 
            pointer-events: none; 
            transition: all 0.6s var(--ease-in-out-cubic); 
            backdrop-filter: blur(0px);
            background: radial-gradient(circle at center, rgba(0,0,0,0.9), rgba(0,0,0,0.7));
        }
        
        #modal-backdrop.visible { 
            opacity: 1; 
            pointer-events: auto; 
            backdrop-filter: blur(20px) saturate(1.3);
        }
        
        #modal-content {
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-primary)); 
            border: 3px solid;
            border-image: linear-gradient(45deg, var(--accent-primary), var(--accent-secondary)) 1;
            box-shadow: 0 0 100px var(--shadow-color), 0 40px 80px rgba(0,0,0,0.5);
            opacity: 0; 
            transform: translateY(80px) scale(0.8) rotateX(20deg);
            transition: all 0.8s var(--ease-bounce);
            width: 95%; 
            max-width: 900px;
            max-height: 90vh;
            position: relative;
            overflow: hidden;
        }
        
        #modal-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary), var(--accent-primary));
            animation: shimmer 1.5s infinite;
        }
        
        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        #modal-backdrop.visible #modal-content { 
            opacity: 1; 
            transform: translateY(0) scale(1) rotateX(0deg); 
        }
        
        #modal-title { 
            text-shadow: 0 0 20px var(--shadow-color);
            background: linear-gradient(45deg, var(--text-heading), var(--accent-primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-family: var(--font-display);
        }

        /* =====================================================================
           10. MEDIA GALLERY SIÊU ĐẲNG CẤP
           ===================================================================== */
        .media-gallery {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        @media (max-width: 768px) {
            .media-gallery {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
        }
        
        .main-media {
            position: relative;
            border-radius: 16px;
            overflow: hidden;
            background: var(--bg-primary);
            aspect-ratio: 16/9;
        }
        
        .main-media video,
        .main-media img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: all 0.5s var(--ease-out-quint);
        }
        
        .main-media:hover video,
        .main-media:hover img {
            transform: scale(1.05);
        }
        
        .media-controls {
            position: absolute;
            bottom: 1rem;
            left: 1rem;
            right: 1rem;
            display: flex;
            gap: 0.5rem;
            z-index: 10;
        }
        
        .media-btn {
            background: rgba(0,0,0,0.7);
            border: 2px solid var(--accent-primary);
            color: var(--accent-primary);
            padding: 0.5rem;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s var(--ease-bounce);
            backdrop-filter: blur(10px);
        }
        
        .media-btn:hover {
            background: var(--accent-primary);
            color: var(--bg-primary);
            transform: scale(1.1);
            box-shadow: 0 0 20px var(--shadow-color);
        }
        
        .media-btn:active {
            transform: scale(0.95);
        }
        
        .media-thumbnails {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            max-height: 400px;
            overflow-y: auto;
        }
        
        @media (max-width: 768px) {
            .media-thumbnails {
                flex-direction: row;
                max-height: none;
                overflow-x: auto;
                overflow-y: hidden;
            }
        }
        
        .thumbnail {
            position: relative;
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s var(--ease-bounce);
            border: 2px solid transparent;
            min-width: 100px;
            aspect-ratio: 16/9;
        }
        
        .thumbnail:hover {
            transform: scale(1.05);
            border-color: var(--accent-primary);
            box-shadow: 0 0 15px var(--shadow-color);
        }
        
        .thumbnail.active {
            border-color: var(--accent-primary);
            box-shadow: 0 0 20px var(--shadow-color);
            transform: scale(1.1);
        }
        
        .thumbnail img,
        .thumbnail video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .thumbnail::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(45deg, transparent, var(--accent-primary), transparent);
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .thumbnail:hover::before {
            opacity: 0.1;
        }
        
        .thumbnail .play-icon {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.7);
            color: var(--accent-primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            backdrop-filter: blur(10px);
            border: 2px solid var(--accent-primary);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); 
            color: black; 
            font-weight: bold; 
            padding: 18px 28px; 
            border-radius: 20px; 
            box-shadow: 0 10px 30px var(--shadow-color); 
            transition: all 0.4s var(--ease-bounce); 
            position: relative;
            overflow: hidden;
            font-family: var(--font-accent);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.6s;
        }
        
        .btn-primary:hover::before {
            left: 100%;
        }
        
        .btn-primary:active { 
            transform: translateY(3px) scale(0.97); 
            box-shadow: 0 5px 15px var(--shadow-color); 
            filter: brightness(1.2);
        }

        /* =====================================================================
           11. HIỆU ỨNG KHỞI TẠO & ANIMATIONS ĐẶC BIỆT
           ===================================================================== */
        .initial-hidden { opacity: 0; }
        
        @keyframes epicEntrance { 
            0% { opacity: 0; transform: translateY(50px) scale(0.8) rotateX(30deg); } 
            60% { opacity: 0.8; transform: translateY(-10px) scale(1.1) rotateX(-5deg); }
            100% { opacity: 1; transform: translateY(0) scale(1) rotateX(0deg); } 
        }
        
        /* Hiệu ứng click cho mọi element */
        * {
            -webkit-tap-highlight-color: transparent;
        }
        
        .theme-card, .nav-item, .theme-option, .btn-primary, .thumbnail, .media-btn {
            user-select: none;
            -webkit-user-select: none;
        }
        
        /* =====================================================================
           12. RESPONSIVE ENHANCEMENTS
           ===================================================================== */
        @media (max-width: 640px) {
            .text-animated {
                font-size: 1.5rem;
            }
            
            .media-gallery {
                grid-template-columns: 1fr;
            }
            
            .media-thumbnails {
                flex-direction: row;
                gap: 0.5rem;
            }
            
            .thumbnail {
                min-width: 80px;
            }
        }
    </style>
</head>
<body class="initial-hidden">
    <canvas id="particles-canvas"></canvas>
    <canvas id="starry-sky"></canvas>
    <div class="floating-icons" id="floating-icons"></div>

    <!-- ===== NỘI DUNG CHÍNH ===== -->
    <main class="flex-1 transition-colors duration-500">
        <div class="max-w-full mx-auto">
            <header class="header flex justify-between items-center mb-6">
                <div>
                    <h2 class="text-4xl font-extrabold tracking-tight text-animated" data-text="Epic Showcase">Epic Showcase</h2>
                    <p class="text-[var(--text-secondary)] mt-1 text-lg text-bounce">Giao diện siêu đẳng cấp ✨</p>
                </div>
                <button id="theme-switcher-btn-header">
                    <i class="fa-solid fa-palette text-3xl"></i>
                </button>
            </header>

            <section class="px-4">
                <div id="themeGrid" class="flex flex-col gap-8">
                    <!-- CÁC THẺ THEME SẼ ĐƯỢC TỰ ĐỘNG CHÈN VÀO ĐÂY -->
                </div>
            </section>
        </div>
    </main>

    <!-- ===== THANH ĐIỀU HƯỚNG DƯỚI CÙNG ===== -->
    <nav class="bottom-nav">
        <a href="#" class="nav-item active">
            <i class="fa-solid fa-layer-group"></i>
            <span class="text-electric">Tất Cả</span>
        </a>
        <a href="#" class="nav-item">
            <i class="fa-solid fa-fire"></i>
            <span class="text-electric">Phổ Biến</span>
        </a>
        <a href="#" class="nav-item">
            <i class="fa-solid fa-star"></i>
            <span class="text-electric">Mới Nhất</span>
        </a>
        <a href="#" class="nav-item">
            <i class="fa-solid fa-headset"></i>
            <span class="text-electric">Hỗ Trợ</span>
        </a>
    </nav>
    
    <!-- ===== MODAL CHỌN THEME ===== -->
    <div id="theme-switcher-modal">
        <div id="theme-menu">
            <h3 class="text-2xl font-bold text-center mb-6 text-animated" data-text="🎨 Chọn Theme Siêu Đẳng Cấp">🎨 Chọn Theme Siêu Đẳng Cấp</h3>
            <div class="grid grid-cols-3 gap-6 place-items-center">
                 <button class="theme-option" data-theme-set="neural-dark" title="Neural Dark ⚡"></button>
                 <button class="theme-option" data-theme-set="purple-mist" title="Purple Mist 🌙"></button>
                 <button class="theme-option" data-theme-set="forest-dew" title="Forest Dew 🌿"></button>
                 <button class="theme-option" data-theme-set="sunset-glow" title="Sunset Glow 🌅"></button>
                 <button class="theme-option" data-theme-set="cosmic-dark" title="Cosmic Dark 🌌"></button>
                 <div></div>
            </div>
        </div>
    </div>

    <!-- ===== MODAL CHI TIẾT THEME VỚI VIDEO & MULTIPLE IMAGES ===== -->
    <div id="modal-backdrop" class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60">
        <div id="modal-content" class="rounded-3xl shadow-2xl overflow-hidden">
            <div class="p-6 flex justify-between items-center border-b border-[var(--border-primary)]">
                <h3 id="modal-title" class="text-2xl font-extrabold text-[var(--text-heading)]"></h3>
                <button id="modal-close-btn" class="text-[var(--text-secondary)] hover:text-[var(--text-primary)] transition-all duration-300">
                    <i class="fa-solid fa-xmark text-2xl"></i>
                </button>
            </div>
            <div class="p-6 max-h-[75vh] overflow-y-auto">
                <div class="flex flex-col gap-y-6">
                    <!-- MEDIA GALLERY -->
                    <div class="media-gallery">
                        <div class="main-media">
                            <div id="main-media-container">
                                <!-- Video hoặc hình ảnh chính sẽ hiển thị ở đây -->
                            </div>
                            <div class="media-controls">
                                <button class="media-btn" id="play-pause-btn" title="Play/Pause">
                                    <i class="fa-solid fa-play"></i>
                                </button>
                                <button class="media-btn" id="fullscreen-btn" title="Fullscreen">
                                    <i class="fa-solid fa-expand"></i>
                                </button>
                                <button class="media-btn" id="volume-btn" title="Mute/Unmute">
                                    <i class="fa-solid fa-volume-high"></i>
                                </button>
                            </div>
                        </div>
                        <div class="media-thumbnails" id="media-thumbnails">
                            <!-- Thumbnails sẽ được tạo động ở đây -->
                        </div>
                    </div>
                    
                    <div>
                        <h4 class="text-lg font-bold text-[var(--text-heading)] mb-2 text-wave">
                            <span style="--i: 0">🌟</span>
                            <span style="--i: 1"> </span>
                            <span style="--i: 2">M</span>
                            <span style="--i: 3">ô</span>
                            <span style="--i: 4"> </span>
                            <span style="--i: 5">T</span>
                            <span style="--i: 6">ả</span>
                            <span style="--i: 7"> </span>
                            <span style="--i: 8">C</span>
                            <span style="--i: 9">h</span>
                            <span style="--i: 10">i</span>
                            <span style="--i: 11"> </span>
                            <span style="--i: 12">T</span>
                            <span style="--i: 13">i</span>
                            <span style="--i: 14">ế</span>
                            <span style="--i: 15">t</span>
                        </h4>
                        <p id="modal-description" class="text-[var(--text-primary)] mb-6 text-base leading-relaxed"></p>

                        <h4 class="text-lg font-bold text-[var(--text-heading)] mb-3 text-wave">
                            <span style="--i: 0">🚀</span>
                            <span style="--i: 1"> </span>
                            <span style="--i: 2">T</span>
                            <span style="--i: 3">í</span>
                            <span style="--i: 4">n</span>
                            <span style="--i: 5">h</span>
                            <span style="--i: 6"> </span>
                            <span style="--i: 7">N</span>
                            <span style="--i: 8">ă</span>
                            <span style="--i: 9">n</span>
                            <span style="--i: 10">g</span>
                            <span style="--i: 11"> </span>
                            <span style="--i: 12">S</span>
                            <span style="--i: 13">i</span>
                            <span style="--i: 14">ê</span>
                            <span style="--i: 15">u</span>
                            <span style="--i: 16"> </span>
                            <span style="--i: 17">Đ</span>
                            <span style="--i: 18">ỉ</span>
                            <span style="--i: 19">n</span>
                            <span style="--i: 20">h</span>
                        </h4>
                        <ul id="modal-features" class="space-y-3"></ul>

                        <!-- ===== PHẦN ĐÃ SỬA LỖI ===== -->
                        <button class="btn-primary w-full mt-8 text-lg">
                            <span class="text-animated" data-text="💎 Mua Ngay & Sở Hữu Siêu Phẩm">💎 Mua Ngay & Sở Hữu Siêu Phẩm</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function () {
        'use strict';

        // =====================================================================
        // 1. DỮ LIỆU & TRẠNG THÁI VỚI VIDEO & MULTIPLE IMAGES
        // =====================================================================
        const themesData = [
            { 
                id: 1, 
                title: "E-commerce Pro Ultra 🛒", 
                category: "🛍️ Shop", 
                short_description: "Giao diện cửa hàng siêu đẳng cấp, tối ưu chuyển đổi 200%! 🚀", 
                long_description: "Thiết kế e-commerce cực kỳ hiện đại với AI-powered recommendations, real-time analytics và conversion optimization. Tích hợp đầy đủ payment gateways và marketing tools tiên tiến nhất.", 
                features: ["🔥 Tối ưu SEO cực mạnh", "📱 Responsive 4K Ready", "⚡ Tốc độ tải 0.5s", "🤖 AI Product Suggestions"], 
                media: {
                    video: "https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4",
                    images: [
                        "https://i.imgur.com/vHZdcod.png",
                        "https://i.imgur.com/tHFNXoT.png",
                        "https://i.imgur.com/Kpz5gRz.png",
                        "https://i.imgur.com/kF2yt5v.png"
                    ]
                }
            },
            { 
                id: 2, 
                title: "Modern Blogster Pro ✍️", 
                category: "📝 Blog", 
                short_description: "Theme blog cá nhân siêu đỉnh, engagement tăng 300%! 📈", 
                long_description: "Giao diện blog tối giản và thanh lịch với advanced typography, reading analytics và social engagement tools. Được tối ưu cho content creators và influencers.", 
                features: ["📖 Reading Experience A+", "🌓 Dark/Light Auto Switch", "🔄 Infinite Scroll Magic", "📊 Real-time Analytics"], 
                media: {
                    video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",
                    images: [
                        "https://i.imgur.com/tHFNXoT.png",
                        "https://i.imgur.com/vHZdcod.png",
                        "https://i.imgur.com/0DmWzT7.png",
                        "https://i.imgur.com/3ZwnV6E.png"
                    ]
                }
            },
            { 
                id: 3, 
                title: "CreativeFolio Epic 🎨", 
                category: "🎭 Portfolio", 
                short_description: "Showcase dự án siêu chuyên nghiệp, wow factor 1000%! ✨", 
                long_description: "Portfolio template với 3D effects, particle systems, và interactive animations. Hoàn hảo cho designers, photographers và creative professionals muốn gây ấn tượng mạnh.", 
                features: ["🔍 3D Isotope Filtering", "✨ Particle Effects", "📧 Contact Form Ajax Pro", "🎬 Video Background Support"], 
                media: {
                    video: "https://sample-videos.com/zip/10/mp4/SampleVideo_640x360_1mb.mp4",
                    images: [
                        "https://i.imgur.com/Kpz5gRz.png",
                        "https://i.imgur.com/0DmWzT7.png",
                        "https://i.imgur.com/vHZdcod.png",
                        "https://i.imgur.com/tHFNXoT.png"
                    ]
                }
            },
            { 
                id: 4, 
                title: "Quantum SaaS Ultimate 💼", 
                category: "🚀 Business", 
                short_description: "Giao diện SaaS tương lai, conversion rate 500%! 🌟", 
                long_description: "Template business cao cấp nhất với advanced pricing tables, customer testimonials carousel, và integrated CRM tools. Được thiết kế cho unicorn startups và enterprise companies.", 
                features: ["💰 Dynamic Pricing Tables", "🎭 3D Micro-interactions", "🎯 A/B Testing Ready", "📈 Built-in Analytics"], 
                media: {
                    video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4",
                    images: [
                        "https://i.imgur.com/kF2yt5v.png",
                        "https://i.imgur.com/vHZdcod.png",
                        "https://i.imgur.com/Kpz5gRz.png",
                        "https://i.imgur.com/3ZwnV6E.png"
                    ]
                }
            },
            { 
                id: 5, 
                title: "Artisan Guild Masterpiece 🖼️", 
                category: "🎨 Portfolio", 
                short_description: "Portfolio nghệ thuật tối giản, tôn vinh tác phẩm 100%! 🏆", 
                long_description: "Thiết kế portfolio nghệ thuật với clean aesthetics, advanced image optimization và virtual gallery experience. Dành cho các nghệ sĩ muốn trưng bày tác phẩm một cách hoàn hảo nhất.", 
                features: ["🧱 Smart Masonry Layout", "🖥️ Virtual Gallery Mode", "✒️ Premium Typography", "🎵 Ambient Sound Effects"], 
                media: {
                    video: "https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_2mb.mp4",
                    images: [
                        "https://i.imgur.com/0DmWzT7.png",
                        "https://i.imgur.com/Kpz5gRz.png",
                        "https://i.imgur.com/tHFNXoT.png",
                        "https://i.imgur.com/kF2yt5v.png"
                    ]
                }
            },
            { 
                id: 6, 
                title: "Gourmet Chef Deluxe 👨‍🍳", 
                category: "🍽️ Food", 
                short_description: "Theme ẩm thực siêu hấp dẫn, engagement tăng 400%! 😋", 
                long_description: "Giao diện blog ẩm thực chuyên nghiệp với recipe calculator, nutrition tracker, và social sharing optimization. Hoàn hảo cho food bloggers và professional chefs.", 
                features: ["📝 Recipe Calculator Pro", "🎥 4K Video Support", "⭐ Review System Advanced", "🔥 Trending Recipes AI"], 
                media: {
                    video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4",
                    images: [
                        "https://i.imgur.com/3ZwnV6E.png",
                        "https://i.imgur.com/0DmWzT7.png",
                        "https://i.imgur.com/vHZdcod.png",
                        "https://i.imgur.com/kF2yt5v.png"
                    ]
                }
            },
        ];
        
        // =====================================================================
        // 2. LẤY CÁC THÀNH PHẦN DOM
        // =====================================================================
        const docHtml = document.documentElement;
        const docBody = document.body;
        const themeGrid = document.getElementById('themeGrid');
        const modalBackdrop = document.getElementById('modal-backdrop');
        const modalCloseBtn = document.getElementById('modal-close-btn');
        const themeSwitcherBtnHeader = document.getElementById('theme-switcher-btn-header');
        const themeSwitcherModal = document.getElementById('theme-switcher-modal');
        const themeMenu = document.getElementById('theme-menu');
        
        // Media controls
        const mainMediaContainer = document.getElementById('main-media-container');
        const mediaThumbnails = document.getElementById('media-thumbnails');
        const playPauseBtn = document.getElementById('play-pause-btn');
        const fullscreenBtn = document.getElementById('fullscreen-btn');
        const volumeBtn = document.getElementById('volume-btn');
        
        let currentMedia = null;
        let currentThemeMedia = null;

        // =====================================================================
        // 3. HIỆU ỨNG PARTICLES SIÊU ĐẲNG CẤP
        // =====================================================================
        const createEpicParticles = () => {
            const canvas = document.getElementById('particles-canvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            const particles = [];
            const particleCount = 80;
            const accentColor = getComputedStyle(docHtml).getPropertyValue('--accent-primary').trim();
            
            class Particle {
                constructor() {
                    this.reset();
                    this.y = Math.random() * canvas.height;
                }
                
                reset() {
                    this.x = Math.random() * canvas.width;
                    this.y = -10;
                    this.speed = Math.random() * 3 + 0.5;
                    this.size = Math.random() * 4 + 1;
                    this.opacity = Math.random() * 0.6 + 0.3;
                    this.angle = 0;
                    this.angleSpeed = (Math.random() - 0.5) * 0.03;
                    this.pulse = Math.random() * Math.PI * 2;
                }
                
                update() {
                    this.y += this.speed;
                    this.x += Math.sin(this.angle) * 1;
                    this.angle += this.angleSpeed;
                    this.pulse += 0.02;
                    
                    if (this.y > canvas.height + 10) {
                        this.reset();
                    }
                }
                
                draw() {
                    const pulseFactor = Math.sin(this.pulse) * 0.3 + 0.7;
                    ctx.save();
                    ctx.globalAlpha = this.opacity * pulseFactor;
                    ctx.fillStyle = accentColor;
                    ctx.shadowBlur = 15;
                    ctx.shadowColor = accentColor;
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.size * pulseFactor, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.restore();
                }
            }
            
            for (let i = 0; i < particleCount; i++) {
                particles.push(new Particle());
            }
            
            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                particles.forEach(particle => {
                    particle.update();
                    particle.draw();
                });
                requestAnimationFrame(animate);
            }
            
            animate();
        };
        
        // =====================================================================
        // 4. ICONS BAY LƯỢN SIÊU ẤN TƯỢNG
        // =====================================================================
        const createFloatingIcons = () => {
            const container = document.getElementById('floating-icons');
            if (!container) return;
            
            const icons = ['fa-rocket', 'fa-star', 'fa-heart', 'fa-gem', 'fa-crown', 'fa-magic', 'fa-bolt', 'fa-fire', 'fa-diamond', 'fa-wand-magic-sparkles'];
            
            setInterval(() => {
                if (container.children.length > 25) return;
                
                const icon = document.createElement('i');
                icon.className = `fa-solid ${icons[Math.floor(Math.random() * icons.length)]} floating-icon`;
                icon.style.left = Math.random() * 100 + '%';
                icon.style.animationDuration = (Math.random() * 8 + 8) + 's';
                icon.style.animationDelay = Math.random() * 2 + 's';
                icon.style.fontSize = (Math.random() * 1 + 1.5) + 'rem';
                
                container.appendChild(icon);
                
                setTimeout(() => {
                    if (icon.parentNode) {
                        icon.parentNode.removeChild(icon);
                    }
                }, 18000);
            }, 2000);
        };
        
        // =====================================================================
        // 5. MEDIA GALLERY FUNCTIONS
        // =====================================================================
        const createMediaGallery = (media) => {
            currentThemeMedia = media;
            
            // Create main media (video first if available)
            if (media.video) {
                showVideo(media.video);
            } else if (media.images && media.images.length > 0) {
                showImage(media.images[0]);
            }
            
            // Create thumbnails
            createThumbnails(media);
        };
        
        const showVideo = (videoUrl) => {
            mainMediaContainer.innerHTML = `
                <video id="main-video" controls muted>
                    <source src="${videoUrl}" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            `;
            currentMedia = document.getElementById('main-video');
            updateMediaControls('video');
        };
        
        const showImage = (imageUrl) => {
            mainMediaContainer.innerHTML = `
                <img id="main-image" src="${imageUrl}" alt="Theme Preview">
            `;
            currentMedia = document.getElementById('main-image');
            updateMediaControls('image');
        };
        
        const createThumbnails = (media) => {
            let thumbnailsHTML = '';
            
            // Add video thumbnail if available
            if (media.video) {
                thumbnailsHTML += `
                    <div class="thumbnail active" data-type="video" data-src="${media.video}">
                        <video muted>
                            <source src="${media.video}" type="video/mp4">
                        </video>
                        <div class="play-icon">
                            <i class="fa-solid fa-play"></i>
                        </div>
                    </div>
                `;
            }
            
            // Add image thumbnails
            if (media.images) {
                media.images.forEach((imageUrl, index) => {
                    const isActive = !media.video && index === 0;
                    thumbnailsHTML += `
                        <div class="thumbnail ${isActive ? 'active' : ''}" data-type="image" data-src="${imageUrl}">
                            <img src="${imageUrl}" alt="Preview ${index + 1}">
                        </div>
                    `;
                });
            }
            
            mediaThumbnails.innerHTML = thumbnailsHTML;
            
            // Add click events to thumbnails
            mediaThumbnails.querySelectorAll('.thumbnail').forEach(thumb => {
                thumb.addEventListener('click', () => {
                    // Remove active class from all thumbnails
                    mediaThumbnails.querySelectorAll('.thumbnail').forEach(t => t.classList.remove('active'));
                    // Add active class to clicked thumbnail
                    thumb.classList.add('active');
                    
                    const type = thumb.dataset.type;
                    const src = thumb.dataset.src;
                    
                    if (type === 'video') {
                        showVideo(src);
                    } else {
                        showImage(src);
                    }
                    
                    // Add confetti effect
                    confetti({
                        particleCount: 30,
                        spread: 50,
                        origin: { 
                            x: thumb.getBoundingClientRect().left / window.innerWidth + 0.05,
                            y: thumb.getBoundingClientRect().top / window.innerHeight + 0.1
                        },
                        colors: [getComputedStyle(docHtml).getPropertyValue('--accent-primary').trim()]
                    });
                });
            });
        };
        
        const updateMediaControls = (type) => {
            if (type === 'video') {
                playPauseBtn.style.display = 'flex';
                volumeBtn.style.display = 'flex';
            } else {
                playPauseBtn.style.display = 'none';
                volumeBtn.style.display = 'none';
            }
        };
        
        // =====================================================================
        // 6. MEDIA CONTROLS EVENT LISTENERS
        // =====================================================================
        if (playPauseBtn) {
            playPauseBtn.addEventListener('click', () => {
                if (currentMedia && currentMedia.tagName === 'VIDEO') {
                    if (currentMedia.paused) {
                        currentMedia.play();
                        playPauseBtn.innerHTML = '<i class="fa-solid fa-pause"></i>';
                    } else {
                        currentMedia.pause();
                        playPauseBtn.innerHTML = '<i class="fa-solid fa-play"></i>';
                    }
                    
                    // Mini confetti
                    confetti({
                        particleCount: 20,
                        spread: 40,
                        origin: { 
                            x: playPauseBtn.getBoundingClientRect().left / window.innerWidth + 0.02,
                            y: playPauseBtn.getBoundingClientRect().top / window.innerHeight + 0.02
                        },
                        colors: [getComputedStyle(docHtml).getPropertyValue('--accent-primary').trim()]
                    });
                }
            });
        }
        
        if (volumeBtn) {
            volumeBtn.addEventListener('click', () => {
                if (currentMedia && currentMedia.tagName === 'VIDEO') {
                    currentMedia.muted = !currentMedia.muted;
                    volumeBtn.innerHTML = currentMedia.muted ? 
                        '<i class="fa-solid fa-volume-xmark"></i>' : 
                        '<i class="fa-solid fa-volume-high"></i>';
                }
            });
        }
        
        if (fullscreenBtn) {
            fullscreenBtn.addEventListener('click', () => {
                if (currentMedia) {
                    if (currentMedia.requestFullscreen) {
                        currentMedia.requestFullscreen();
                    } else if (currentMedia.webkitRequestFullscreen) {
                        currentMedia.webkitRequestFullscreen();
                    } else if (currentMedia.msRequestFullscreen) {
                        currentMedia.msRequestFullscreen();
                    }
                    
                    // Explosion confetti
                    confetti({
                        particleCount: 100,
                        spread: 90,
                        origin: { y: 0.5 },
                        colors: [getComputedStyle(docHtml).getPropertyValue('--accent-primary').trim()]
                    });
                }
            });
        }
        
        // =====================================================================
        // 7. RENDER THEMES VỚI HIỆU ỨNG ĐỈNH CAO
        // =====================================================================
        const renderThemes = () => {
            if (!themeGrid) return;
            let cardsHTML = '';
            themesData.forEach((theme, index) => {
                const imageHTML = `<div class="card-image-wrapper h-56 rounded-t-2xl overflow-hidden"><img src="${theme.media.images[0]}" alt="${theme.title}" class="w-full h-full object-cover"></div>`;
                const titleWave = createWaveText(theme.title);
                const contentHTML = `<div class="p-5"><div class="flex justify-between items-start gap-4 mb-2"><h4 class="text-xl font-bold text-[var(--text-heading)] text-electric">${titleWave}</h4><div class="category-pill flex-shrink-0">${theme.category}</div></div><p class="text-base text-[var(--text-secondary)]">${theme.short_description}</p></div>`;
                cardsHTML += `<div class="theme-card" data-id="${theme.id}" style="transition-delay: ${index * 100}ms; animation-delay: ${index * 200}ms;">${imageHTML}${contentHTML}</div>`;
            });
            themeGrid.innerHTML = cardsHTML;
            setupScrollAnimations();
        };
        
        const createWaveText = (text) => {
            return text.split('').map((char, index) => {
                if (char === ' ') return ' ';
                return `<span style="--i: ${index}">${char}</span>`;
            }).join('');
        };
        
        // =====================================================================
        // 8. SCROLL ANIMATIONS SIÊU MƯỢT
        // =====================================================================
        const setupScrollAnimations = () => {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        // Thêm confetti khi card xuất hiện
                        setTimeout(() => {
                            const rect = entry.target.getBoundingClientRect();
                            confetti({
                                particleCount: 40,
                                spread: 70,
                                origin: {
                                    x: (rect.left + rect.width/2) / window.innerWidth,
                                    y: (rect.top + rect.height/2) / window.innerHeight
                                },
                                colors: [getComputedStyle(docHtml).getPropertyValue('--accent-primary').trim()]
                            });
                        }, 600);
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1, rootMargin: "0px 0px -50px 0px" });
            
            document.querySelectorAll('.theme-card').forEach(el => observer.observe(el));
        };

        // =====================================================================
        // 9. STARRY SKY VỚI HIỆU ỨNG ĐỈNH CAO
        // =====================================================================
        let animationFrameId;
        const createEnhancedStarrySky = () => {
            if (animationFrameId) cancelAnimationFrame(animationFrameId);
            const canvas = document.getElementById('starry-sky');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            const accentColor = getComputedStyle(docHtml).getPropertyValue('--accent-primary').trim();
            const secondaryColor = getComputedStyle(docHtml).getPropertyValue('--accent-secondary').trim();
            const numStars = 120;
            let stars = [];

            class Star {
                constructor() {
                    this.x = Math.random() * canvas.width;
                    this.y = Math.random() * canvas.height;
                    this.radius = Math.random() * 3 + 0.5;
                    this.alpha = Math.random() * 0.9 + 0.1;
                    this.twinkleSpeed = (Math.random() - 0.5) * 0.03;
                    this.color = Math.random() > 0.5 ? accentColor : secondaryColor;
                    this.pulsePhase = Math.random() * Math.PI * 2;
                    this.pulseSpeed = Math.random() * 0.02 + 0.01;
                }
                
                update() {
                    this.alpha += this.twinkleSpeed;
                    if (this.alpha <= 0.1 || this.alpha >= 1) this.twinkleSpeed *= -1;
                    this.pulsePhase += this.pulseSpeed;
                }
                
                draw() {
                    const pulse = Math.sin(this.pulsePhase) * 0.4 + 0.6;
                    ctx.save();
                    ctx.globalAlpha = this.alpha * pulse;
                    ctx.fillStyle = this.color;
                    ctx.shadowBlur = 20;
                    ctx.shadowColor = this.color;
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.radius * pulse, 0, 2 * Math.PI);
                    ctx.fill();
                    ctx.restore();
                }
            }

            for (let i = 0; i < numStars; i++) {
                stars.push(new Star());
            }

            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                stars.forEach(star => {
                    star.update();
                    star.draw();
                });
                animationFrameId = requestAnimationFrame(animate);
            }
            animate();
        };
        
        // =====================================================================
        // 10. MODAL LOGIC VỚI HIỆU ỨNG ĐỈNH CAO
        // =====================================================================
        const openThemeDetailsModal = (theme) => {
            modalBackdrop.classList.add('visible');
            docBody.style.overflow = 'hidden';
            document.getElementById('modal-title').textContent = theme.title;
            document.getElementById('modal-description').textContent = theme.long_description;
            document.getElementById('modal-features').innerHTML = theme.features.map(f =>
                `<li class="flex items-center text-base text-[var(--text-primary)]"><i class="fa-solid fa-circle-check text-lg mr-3 text-[var(--accent-primary)]"></i><span>${f}</span></li>`
            ).join('');
            
            // Create media gallery
            createMediaGallery(theme.media);
            
            // Super confetti khi mở modal
            setTimeout(() => {
                confetti({
                    particleCount: 150,
                    spread: 80,
                    origin: { y: 0.6 },
                    colors: [getComputedStyle(docHtml).getPropertyValue('--accent-primary').trim()]
                });
            }, 400);
        };
        
        const closeThemeDetailsModal = () => {
            modalBackdrop.classList.remove('visible');
            docBody.style.overflow = '';
            
            // Stop any playing video
            if (currentMedia && currentMedia.tagName === 'VIDEO') {
                currentMedia.pause();
            }
        };

        const toggleThemeSwitcherModal = (show) => {
            if (show) {
                themeSwitcherModal.classList.add('visible');
                docBody.style.overflow = 'hidden';
                // Confetti khi mở theme switcher
                setTimeout(() => {
                    confetti({
                        particleCount: 80,
                        spread: 70,
                        origin: { y: 0.3 },
                        colors: [getComputedStyle(docHtml).getPropertyValue('--accent-primary').trim()]
                    });
                }, 300);
            } else {
                themeSwitcherModal.classList.remove('visible');
                docBody.style.overflow = '';
            }
        };

        // =====================================================================
        // 11. THEME SWITCHING VỚI HIỆU ỨNG ĐỈNH CAO
        // =====================================================================
        const applyTheme = (themeName) => {
            docHtml.setAttribute('data-theme', themeName);
            localStorage.setItem('theme', themeName);
            document.querySelectorAll('.theme-option').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.themeSet === themeName);
            });
            
            // Mega confetti khi đổi theme
            confetti({
                particleCount: 300,
                spread: 100,
                origin: { y: 0.5 },
                colors: [getComputedStyle(docHtml).getPropertyValue('--accent-primary').trim()]
            });
            
            setTimeout(() => {
                createEnhancedStarrySky();
                createEpicParticles();
            }, 600);
            
            toggleThemeSwitcherModal(false);
        };

        // =====================================================================
        // 12. EVENT LISTENERS
        // =====================================================================
        
        // Mở Modal chi tiết theme với hiệu ứng
        if (themeGrid) themeGrid.addEventListener('click', (e) => {
            const card = e.target.closest('.theme-card');
            if (card) {
                // Hiệu ứng click
                card.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    card.style.transform = '';
                }, 150);
                
                const themeId = parseInt(card.dataset.id, 10);
                const selectedTheme = themesData.find(t => t.id === themeId);
                openThemeDetailsModal(selectedTheme);
            }
        });

        // Đóng Modal chi tiết theme
        if (modalCloseBtn) modalCloseBtn.addEventListener('click', closeThemeDetailsModal);
        if (modalBackdrop) modalBackdrop.addEventListener('click', (e) => {
            if (e.target === modalBackdrop) closeThemeDetailsModal();
        });

        // Mở/Đóng Modal chọn theme
        if (themeSwitcherBtnHeader) themeSwitcherBtnHeader.addEventListener('click', () => toggleThemeSwitcherModal(true));
        if (themeSwitcherModal) themeSwitcherModal.addEventListener('click', (e) => {
            if (e.target === themeSwitcherModal) toggleThemeSwitcherModal(false);
        });
        
        // Chọn theme với hiệu ứng
        if (themeMenu) themeMenu.addEventListener('click', (e) => {
            const button = e.target.closest('.theme-option');
            if (button) {
                applyTheme(button.dataset.themeSet);
            }
        });

        // Navigation effects
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', (e) => {
                e.preventDefault();
                document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
                item.classList.add('active');
                
                // Mini confetti cho nav
                confetti({
                    particleCount: 25,
                    spread: 50,
                    origin: { 
                        x: item.getBoundingClientRect().left / window.innerWidth + 0.05,
                        y: 0.9 
                    },
                    colors: [getComputedStyle(docHtml).getPropertyValue('--accent-primary').trim()]
                });
            });
        });

        // =====================================================================
        // 13. KHỞI TẠO SIÊU ĐẲNG CẤP
        // =====================================================================
        function init() {
            // Fade in body với delay để tạo dramatic effect
            setTimeout(() => {
                docBody.classList.remove('initial-hidden');
            }, 100);
            
            // Load theme
            const savedTheme = localStorage.getItem('theme') || 'neural-dark';
            applyTheme(savedTheme);
            
            // Close modals
            toggleThemeSwitcherModal(false);
            
            // Render content
            renderThemes();
            
            // Start animations
            createEnhancedStarrySky();
            createEpicParticles();
            createFloatingIcons();
            
            // Resize handlers
            window.addEventListener('resize', () => {
                createEnhancedStarrySky();
                createEpicParticles();
            });
            
            // Welcome mega confetti
            setTimeout(() => {
                confetti({
                    particleCount: 200,
                    spread: 90,
                    origin: { y: 0.6 },
                    colors: [getComputedStyle(docHtml).getPropertyValue('--accent-primary').trim()]
                });
            }, 1500);
            
            // Additional welcome effects
            setTimeout(() => {
                confetti({
                    particleCount: 100,
                    spread: 60,
                    origin: { x: 0.2, y: 0.7 },
                    colors: [getComputedStyle(docHtml).getPropertyValue('--accent-secondary').trim()]
                });
            }, 2000);
            
            setTimeout(() => {
                confetti({
                    particleCount: 100,
                    spread: 60,
                    origin: { x: 0.8, y: 0.7 },
                    colors: [getComputedStyle(docHtml).getPropertyValue('--accent-primary').trim()]
                });
            }, 2500);
        }
        
        init();
    });
    </script>
</body>
</html>
